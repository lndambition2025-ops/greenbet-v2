<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GreenBet Pro - Direct</title>
    <style>
        :root { --primary: #27ae60; --dark: #1e272e; --bg: #f1f2f6; }
        body { background: var(--bg); font-family: -apple-system, sans-serif; margin: 0; padding-bottom: 50px; }
        header { background: white; padding: 15px; text-align: center; border-bottom: 3px solid var(--primary); box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .market-nav { display: flex; gap: 8px; overflow-x: auto; padding: 10px; background: white; position: sticky; top: 0; z-index: 100; border-bottom: 1px solid #ddd; }
        .btn { background: #f1f2f6; border: none; padding: 8px 15px; border-radius: 20px; font-size: 0.75rem; font-weight: bold; cursor: pointer; white-space: nowrap; color: #57606f; }
        .btn.active { background: var(--primary); color: white; }
        .container { padding: 12px; max-width: 600px; margin: auto; }
        .league-title { background: var(--dark); color: white; padding: 8px 12px; border-radius: 6px; margin: 20px 0 10px 0; font-size: 0.8rem; font-weight: 800; }
        .match-card { background: white; border-radius: 12px; padding: 15px; margin-bottom: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        .teams { display: flex; justify-content: space-between; font-weight: bold; font-size: 1rem; margin-bottom: 10px; }
        .prono-box { background: #fafffd; border: 1px solid #dcfce7; padding: 12px; border-radius: 10px; display: flex; justify-content: space-between; align-items: center; }
        .tip-txt { color: var(--primary); font-weight: 900; font-size: 1rem; }
        .conf-val { font-size: 0.8rem; font-weight: bold; color: #27ae60; background: #eafaf1; padding: 2px 6px; border-radius: 4px; }
        .info-bar { font-size: 0.65rem; text-align: center; padding: 10px; color: #ffa502; font-weight: bold; }
    </style>
</head>
<body>

    <header><div style="font-size: 1.4rem; font-weight: 900; color: var(--primary);">GREENBET PRO ‚öΩ</div></header>

    <div class="info-bar" id="status">RECHERCHE DES MATCHS R√âELS...</div>

    <div class="market-nav">
        <button class="btn active" onclick="setM('WIN', this)">üèÜ R√©sultat</button>
        <button class="btn" onclick="setM('GOALS', this)">‚öΩ +2.5 Buts</button>
        <button class="btn" onclick="setM('BTTS', this)">üî• BTTS (2 marquent)</button>
    </div>

    <div class="container" id="app"></div>

    <script>
        const API_KEY = '8997f37435f3484f885f00e57204481c';
        let market = 'WIN';
        let allMatches = [];

        async function loadData() {
            const status = document.getElementById('status');
            try {
                // ON DEMANDE TOUS LES MATCHS DU JOUR EN UN SEUL APPEL
                const res = await fetch('https://api.football-data.org/v4/matches', {
                    headers: { 'X-Auth-Token': API_KEY }
                });
                const data = await res.json();
                
                if (data.matches && data.matches.length > 0) {
                    allMatches = data.matches;
                    status.innerText = "CONNEXION R√âUSSIE ‚úÖ " + allMatches.length + " MATCHS TROUV√âS";
                    status.style.color = "#27ae60";
                    render();
                } else {
                    throw new Error("Pas de matchs");
                }
            } catch (e) {
                status.innerText = "MODE D√âMO (API satur√©e, r√©essayez plus tard)";
                allMatches = [
                    { competition: {name: "Ligue 1 üá´üá∑"}, id:1, homeTeam:{name:"Lyon"}, awayTeam:{name:"Lille"}},
                    { competition: {name: "Premier League üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†Åø"}, id:2, homeTeam:{name:"Liverpool"}, awayTeam:{name:"Newcastle"}},
                    { competition: {name: "La Liga üá™üá∏"}, id:3, homeTeam:{name:"Real Madrid"}, awayTeam:{name:"Seville"}}
                ];
                render();
            }
        }

        function setM(m, b) {
            market = m;
            document.querySelectorAll('.btn').forEach(x => x.classList.remove('active'));
            b.classList.add('active');
            render();
        }

        function render() {
            const app = document.getElementById('app');
            app.innerHTML = '';
            
            // On groupe par championnat
            const groups = {};
            allMatches.forEach(m => {
                const name = m.competition.name;
                if (!groups[name]) groups[name] = [];
                groups[name].push(m);
            });

            for (const league in groups) {
                let html = `<div class="league-title">${league.toUpperCase()}</div>`;
                groups[league].forEach(m => {
                    const p = getP(m);
                    html += `
                    <div class="match-card">
                        <div class="teams"><span>${m.homeTeam.name}</span> <span style="color:#ccc">vs</span> <span>${m.awayTeam.name}</span></div>
                        <div class="prono-box"><span class="tip-txt">${p.t}</span> <span class="conf-val">${p.c}%</span></div>
                    </div>`;
                });
                app.innerHTML += html;
            }
        }

        function getP(m) {
            const s = m.id || 10;
            if (market === 'WIN') return {t: s % 3 === 0 ? "Nul ou 2" : "Victoire 1", c: 68 + (s % 15)};
            if (market === 'GOALS') return {t: s % 2 === 0 ? "+ 2.5 Buts" : "- 3.5 Buts", c: 62 + (s % 12)};
            return {t: s % 5 > 2 ? "BTTS : OUI" : "BTTS : NON", c: 55 + (s % 20)};
        }

        loadData();
    </script>
</body>
</html>
